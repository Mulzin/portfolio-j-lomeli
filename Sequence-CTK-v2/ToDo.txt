This is an old program and needs a complete rewrite
